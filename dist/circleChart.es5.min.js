(function(a){"use strict";a.fn.circleChart=function(g){var r=this,h={color:"#3459eb",backgroundColor:"#e6e6e6",background:!0,speed:2e3,widthRatio:0.2,value:66,unit:"percent",counterclockwise:!1,size:110,startAngle:0,animate:!0,backgroundFix:!0,lineCap:"round",animation:"easeInOutCubic",text:!1,redraw:!1,cAngle:0,textCenter:!0,textSize:!1,textWeight:"normal",textFamily:"sans-serif",relativeTextSize:1/7,autoCss:!0,onDraw:!1};Math.linearTween=function(s,u,v,w){return v*s/w+u},Math.easeInQuad=function(s,u,v,w){return s/=w,v*s*s+u},Math.easeOutQuad=function(s,u,v,w){return s/=w,-v*s*(s-2)+u},Math.easeInOutQuad=function(s,u,v,w){return(s/=w/2,1>s)?v/2*s*s+u:(s--,-v/2*(s*(s-2)-1)+u)},Math.easeInCubic=function(s,u,v,w){return s/=w,v*s*s*s+u},Math.easeOutCubic=function(s,u,v,w){return s/=w,s--,v*(s*s*s+1)+u},Math.easeInOutCubic=function(s,u,v,w){return(s/=w/2,1>s)?v/2*s*s*s+u:(s-=2,v/2*(s*s*s+2)+u)},Math.easeInQuart=function(s,u,v,w){return s/=w,v*s*s*s*s+u},Math.easeOutQuart=function(s,u,v,w){return s/=w,s--,-v*(s*s*s*s-1)+u},Math.easeInOutQuart=function(s,u,v,w){return(s/=w/2,1>s)?v/2*s*s*s*s+u:(s-=2,-v/2*(s*s*s*s-2)+u)},Math.easeInQuint=function(s,u,v,w){return s/=w,v*s*s*s*s*s+u},Math.easeOutQuint=function(s,u,v,w){return s/=w,s--,v*(s*s*s*s*s+1)+u},Math.easeInOutQuint=function(s,u,v,w){return(s/=w/2,1>s)?v/2*s*s*s*s*s+u:(s-=2,v/2*(s*s*s*s*s+2)+u)},Math.easeInSine=function(s,u,v,w){return-v*Math.cos(s/w*(Math.PI/2))+v+u},Math.easeOutSine=function(s,u,v,w){return v*Math.sin(s/w*(Math.PI/2))+u},Math.easeInOutSine=function(s,u,v,w){return-v/2*(Math.cos(Math.PI*s/w)-1)+u},Math.easeInExpo=function(s,u,v,w){return v*Math.pow(2,10*(s/w-1))+u},Math.easeOutExpo=function(s,u,v,w){return v*(-Math.pow(2,-10*s/w)+1)+u},Math.easeInOutExpo=function(s,u,v,w){return(s/=w/2,1>s)?v/2*Math.pow(2,10*(s-1))+u:(s--,v/2*(-Math.pow(2,-10*s)+2)+u)},Math.easeInCirc=function(s,u,v,w){return s/=w,-v*(Math.sqrt(1-s*s)-1)+u},Math.easeOutCubic=function(s,u,v,w){return s/=w,s--,v*(s*s*s+1)+u},Math.easeInOutCubic=function(s,u,v,w){return(s/=w/2,1>s)?v/2*s*s*s+u:(s-=2,v/2*(s*s*s+2)+u)},Math.easeOutCirc=function(s,u,v,w){return s/=w,s--,v*Math.sqrt(1-s*s)+u},Math.easeInOutCirc=function(s,u,v,w){return(s/=w/2,1>s)?-v/2*(Math.sqrt(1-s*s)-1)+u:(s-=2,v/2*(Math.sqrt(1-s*s)+1)+u)};var i=function(s,u,v,w,x,y,z,A){var B=Object.create(i.prototype);return B.pos=s,B.bAngle=u,B.eAngle=v,B.cAngle=w,B.radius=x,B.lineWidth=y,B.sAngle=z,B.settings=A,B};i.prototype={onDraw:function onDraw(s){if(!1!==this.settings.onDraw){var v=Object.assign({},this),u={percent:p,rad:function rad(w){return w},"default":m};v.value=(u[this.settings.unit]||u["default"])(v.cAngle),v.text=function(w){return j(s,w)},v.settings.onDraw(s,v)}},drawBackground:function drawBackground(s){s.beginPath(),s.arc(this.pos,this.pos,this.settings.backgroundFix?0.9999*this.radius:this.radius,0,2*Math.PI),s.lineWidth=this.settings.backgroundFix?0.95*this.lineWidth:this.lineWidth,s.strokeStyle=this.settings.backgroundColor,s.stroke()},draw:function draw(s){if(s.beginPath(),this.settings.counterclockwise){var u=2*Math.PI;s.arc(this.pos,this.pos,this.radius,u-this.bAngle,u-(this.bAngle+this.cAngle),this.settings.counterclockwise)}else s.arc(this.pos,this.pos,this.radius,this.bAngle,this.bAngle+this.cAngle,this.settings.counterclockwise);s.lineWidth=this.lineWidth,s.lineCap=this.settings.lineCap,s.strokeStyle=this.settings.color,s.stroke()},animate:function animate(s,u,v,w,x){var z=this,y=new Date().getTime()-v;1>y&&(y=1),v-w<1.05*this.settings.speed&&(!x&&1e3*this.cAngle<=Math.floor(1e3*this.eAngle)||x&&1e3*this.cAngle>=Math.floor(1e3*this.eAngle))?(this.cAngle=Math[this.settings.animation]((v-w)/y,this.sAngle,this.eAngle-this.sAngle,this.settings.speed/y),u.clearRect(0,0,this.settings.size,this.settings.size),this.settings.background&&this.drawBackground(u),this.draw(u),this.onDraw(s),v=new Date().getTime(),q(function(){return z.animate(s,u,v,w,x)})):(this.cAngle=this.eAngle,u.clearRect(0,0,this.settings.size,this.settings.size),this.settings.background&&this.drawBackground(u),this.draw(u),this.setCurrentAnglesData(s))},setCurrentAnglesData:function setCurrentAnglesData(s){var u={percent:p,rad:function rad(w){return w},"default":m},v=u[this.settings.unit]||u["default"];s.data("current-c-angle",v(this.cAngle)),s.data("current-start-angle",v(this.bAngle))}};var j=function(s,u){s.data("text",u),a(".circleChart_text",s).html(u)},l=function(s){var u=s.getContext("2d"),v=window.devicePixelRatio||1,w=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1,x=v/w,y=s.width,z=s.height;s.width=y*x,s.height=z*x,s.style.width=y+"px",s.style.height=z+"px",u.scale(x,x)},m=function(s){return 180*(s/Math.PI)},n=function(s){return s/180*Math.PI},o=function(s){return n(360*(s/100))},p=function(s){return 100*(m(s)/360)},q=function(s){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(){window.setTimeout(s,1e3/60)}}();return this.each(function(s,u){var E=a(u),v={},w=E.data();for(var F in w)w.hasOwnProperty(F)&&0===F.indexOf("_cache_")&&h.hasOwnProperty(F.substring(7))&&(v[F.substring(7)]=w[F]);var G=Object.assign({},h,v,w,g);for(var H in G)0!==H.indexOf("_cache_")&&E.data("_cache_"+H,G[H]);a("canvas.circleChart_canvas",E).length||(E.append(function(){return a("<canvas/>",{"class":"circleChart_canvas"}).prop({width:G.size,height:G.size}).css(G.autoCss?{"margin-left":"auto","margin-right":"auto",display:"block"}:{})}),l(a("canvas",E).get(0))),a("p.circleChart_text",E).length||!1===G.text||(E.append("<p class='circleChart_text'>"+G.text+"</p>"),G.autoCss&&(G.textCenter?a("p.circleChart_text",E).css({position:"absolute","line-height":G.size+"px",top:0,width:"100%",margin:0,padding:0,"text-align":"center","font-size":!1===G.textSize?G.size*G.relativeTextSize:G.textSize,"font-weight":G.textWeight,"font-family":G.textFamily}):a("p.circleChart_text",E).css({"padding-top":"5px","text-align":"center","font-weight":G.textWeight,"font-family":G.textFamily,"font-size":!1===G.textSize?G.size*G.relativeTextSize:G.textSize}))),G.autoCss&&E.css("position","relative"),G.redraw||(G.cAngle=G.currentCAngle?G.currentCAngle:G.cAngle,G.startAngle=G.currentStartAngle?G.currentStartAngle:G.startAngle);var x=a("canvas",E).get(0),y=x.getContext("2d"),z={percent:o,rad:function rad(M){return M},"default":n},I=z[G.unit]||z["default"],J=I(G.startAngle),K=I(G.value),L=I(G.cAngle),A=G.size/2,B=A*(1-G.widthRatio/2),C=B*G.widthRatio,D=i(A,J,K,L,B,C,L,G);E.data("size",G.size),G.animate?0===G.value?q(function(){y.clearRect(0,0,r.settings.size,r.settings.size),D.settings.background&&D.drawBackground(y)}):D.animate(E,y,new Date().getTime(),new Date().getTime(),L>K):(D.cAngle=D.eAngle,q(function(){G.background&&D.drawBackground(y),0===G.value?(y.clearRect(0,0,r.settings.size,r.settings.size),D.settings.background&&D.drawBackground(y)):(D.draw(y),D.onDraw(E),D.setCurrentAnglesData(E))}))})}})(jQuery);
